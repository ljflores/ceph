# renamed tasks: to upgrade-sequence:
upgrade-sequence:
   sequential:
   - print: "**** done start upgrade, wait"
   - cephadm.shell:
       env: [sha1]
       mon.a:
         - ceph config set global log_to_journald false --force
         - ceph orch upgrade start --image quay.ceph.io/ceph-ci/ceph:$sha1
         - while ceph orch upgrade status | jq '.in_progress' | grep true ; do ceph orch ps ; ceph versions ; sleep 30 ; done
         - ceph orch ps
         - ceph versions
         - ceph versions | jq -e '.overall | length == 1'
         - ceph versions | jq -e '.overall | keys' | grep $sha1
   - print: "**** done end upgrade, wait..."

   - print: "**** done start telemetry x..."
   - cephadm.shell:
       mon.a:
           - ceph -s
           - ceph config get mgr mgr/telemetry/last_opt_revision
           - ceph telemetry preview
           - ceph telemetry preview-device
           - ceph telemetry channel ls
           - ceph telemetry collection ls
   - print: "**** done end telemetry x..."
